<?xml version="1.0"?>
<Container version="2">
  <Name>UnifiedLedger</Name>
  <Repository>ghcr.io/shakes63/unifiedledger:latest</Repository>
  <Registry>https://ghcr.io</Registry>
  <Network>bridge</Network>
  <Shell>bash</Shell>
  <Privileged>false</Privileged>

  <Support>https://github.com/shakes63/unifiedledger/issues</Support>
  <Project>https://github.com/shakes63/unifiedledger</Project>

  <Overview>
Unified Ledger (Next.js) personal finance app.

Default DB: SQLite persisted in /config/finance.db
Optional DB: Postgres via DATABASE_URL (install Postgres separately in Unraid CA; Postgres 17+)

On startup, the container auto-runs migrations for the configured database, enabling 1-click updates.
  </Overview>

  <Category>Finance: Tools</Category>
  <Icon>https://raw.githubusercontent.com/shakes63/unifiedledger/main/public/logo.png</Icon>
  <WebUI>http://[IP]:[PORT:3000]/</WebUI>

  <!-- Persistent appdata -->
  <Config Name="Appdata" Target="/config" Default="/mnt/user/appdata/unifiedledger" Mode="rw"
          Description="Persistent data (SQLite DB, uploads, config)" Type="Path" Display="always" Required="true"/>

  <!-- Port: Target=container port (fixed), Default=host port (changeable) -->
  <Config Name="Host Port" Target="3000" Default="3000" Mode="tcp"
          Description="Port to access UnifiedLedger on your network (container always uses 3000 internally)" Type="Port" Display="always" Required="true"/>

  <!-- User/Group IDs for file permissions (Unraid standard) -->
  <Config Name="PUID" Target="PUID" Default="99" Mode="rw"
          Description="User ID for file permissions (99 = nobody on Unraid)" Type="Variable" Display="always" Required="false"/>
  <Config Name="PGID" Target="PGID" Default="100" Mode="rw"
          Description="Group ID for file permissions (100 = users on Unraid)" Type="Variable" Display="always" Required="false"/>

  <!-- Required app env -->
  <Config Name="App URL" Target="NEXT_PUBLIC_APP_URL" Default="http://[IP]:[PORT:3000]" Mode="rw"
          Description="Public base URL used for auth redirects and email links" Type="Variable" Display="always" Required="true"/>

  <Config Name="Better Auth Secret" Target="BETTER_AUTH_SECRET" Default="" Mode="rw"
          Description="Required. Set a long random secret." Type="Variable" Display="always" Required="true" Mask="true"/>

  <Config Name="Force Secure Cookies (advanced)" Target="FORCE_SECURE_COOKIES" Default="false" Mode="rw"
          Description="Advanced. If false, Secure cookies are enabled automatically when NEXT_PUBLIC_APP_URL is https. Set true only if you need to force Secure cookies."
          Type="Variable" Display="advanced" Required="false"/>

  <!-- Database selection -->
  <Config Name="DATABASE_URL (SQLite default, Postgres optional)" Target="DATABASE_URL" Default="file:/config/finance.db" Mode="rw"
          Description="SQLite: file:/config/finance.db  |  Postgres: postgresql://user:pass@host:5432/unifiedledger"
          Type="Variable" Display="always" Required="true"/>

  <!-- Uploads persistence (recommended) -->
  <Config Name="UPLOADS_DIR" Target="UPLOADS_DIR" Default="/config/uploads" Mode="rw"
          Description="Filesystem uploads root (avatars at /uploads/avatars/<userId>.jpg). Persist under /config in Unraid."
          Type="Variable" Display="advanced" Required="false"/>

  <!-- Runtime flags (advanced - typically no need to change) -->
  <Config Name="NEXT_TELEMETRY_DISABLED" Target="NEXT_TELEMETRY_DISABLED" Default="1" Mode="rw"
          Description="Disable Next.js telemetry" Type="Variable" Display="advanced" Required="false"/>

  <!-- Optional email -->
  <Config Name="Email Provider" Target="EMAIL_PROVIDER" Default="none" Mode="rw"
          Description="none | resend | smtp" Type="Variable" Display="advanced" Required="false"/>

  <Config Name="Resend API Key" Target="RESEND_API_KEY" Default="" Mode="rw"
          Description="Resend API key (if using resend)" Type="Variable" Display="advanced" Required="false" Mask="true"/>
  <Config Name="Resend From Email" Target="RESEND_FROM_EMAIL" Default="onboarding@resend.dev" Mode="rw"
          Description="From email for Resend" Type="Variable" Display="advanced" Required="false"/>
  <Config Name="Resend From Name" Target="RESEND_FROM_NAME" Default="Unified Ledger" Mode="rw"
          Description="From name for Resend" Type="Variable" Display="advanced" Required="false"/>

  <Config Name="SMTP Host" Target="SMTP_HOST" Default="" Mode="rw"
          Description="SMTP host (if using smtp)" Type="Variable" Display="advanced" Required="false"/>
  <Config Name="SMTP Port" Target="SMTP_PORT" Default="587" Mode="rw"
          Description="SMTP port" Type="Variable" Display="advanced" Required="false"/>
  <Config Name="SMTP Secure" Target="SMTP_SECURE" Default="false" Mode="rw"
          Description="true for SMTPS/465" Type="Variable" Display="advanced" Required="false"/>
  <Config Name="SMTP User" Target="SMTP_USER" Default="" Mode="rw"
          Description="SMTP username" Type="Variable" Display="advanced" Required="false"/>
  <Config Name="SMTP Password" Target="SMTP_PASSWORD" Default="" Mode="rw"
          Description="SMTP password" Type="Variable" Display="advanced" Required="false" Mask="true"/>
  <Config Name="SMTP From" Target="SMTP_FROM" Default="noreply@localhost" Mode="rw"
          Description="From email for SMTP" Type="Variable" Display="advanced" Required="false"/>
  <Config Name="SMTP From Name" Target="SMTP_FROM_NAME" Default="Unified Ledger" Mode="rw"
          Description="From name for SMTP" Type="Variable" Display="advanced" Required="false"/>

  <!-- Optional OAuth -->
  <Config Name="Google Client ID" Target="GOOGLE_CLIENT_ID" Default="" Mode="rw"
          Description="Optional Google OAuth client ID" Type="Variable" Display="advanced" Required="false"/>
  <Config Name="Google Client Secret" Target="GOOGLE_CLIENT_SECRET" Default="" Mode="rw"
          Description="Optional Google OAuth client secret" Type="Variable" Display="advanced" Required="false" Mask="true"/>
  <Config Name="GitHub Client ID" Target="GITHUB_CLIENT_ID" Default="" Mode="rw"
          Description="Optional GitHub OAuth client ID" Type="Variable" Display="advanced" Required="false"/>
  <Config Name="GitHub Client Secret" Target="GITHUB_CLIENT_SECRET" Default="" Mode="rw"
          Description="Optional GitHub OAuth client secret" Type="Variable" Display="advanced" Required="false" Mask="true"/>

  <!-- Optional encryption -->
  <Config Name="OAuth Encryption Key" Target="OAUTH_ENCRYPTION_KEY" Default="" Mode="rw"
          Description="Optional encryption key for OAuth settings at rest" Type="Variable" Display="advanced" Required="false" Mask="true"/>
</Container>


