COMPLETED BUGS:
✅ 1. the category and accounts dropdown on the bill form are not connected to the categories and accounts
✅ 2. when creating a new transaction the default date should be today
✅ 3. There should be a way to mark an account as being a Business Account and that should trigger the sales tax tracking for that account.
✅ 4. If there are multiple business accounts the sales tax should be tracked separately.
✅ 5. Everywhere that you can add a category or tag there should be an option to create them inline.
✅ 6. there should be some padding in between the sidebar and the page content. The dashboard is a good example of the amount of padding it should have. Check all of the pages and ensure the padding is like the dashboard page.
✅ 7. When trying to create an account the submit button is not creating the account.
✅ 8. the dropdowns across the app are completely transparent, turn up the opacity so that they can be read easier.
✅ 9. when creating a transaction there should only be a transfer type instead of transfer in and transfer out. If Transfer is selected it should show a From Account and To Account dropdowns.
✅ 10. the transaction form is doubled up there should only be one.
✅ 11. make the cards on the categories page more compact.
✅ 12. Account creation was failing with 500 error - fixed missing is_business_account database column
✅ 13. Sidebar dashboard was highlighted even when a different option was selected - fixed isActive() function
✅ 14. Transfer form showed duplicate "Account" labels - fixed by making AccountSelector label customizable
✅ 15. Category cards were too large - made them significantly smaller (p-2, reduced fonts, gap-2)
✅ 16. Categories couldn't be marked as tax deductible - added isTaxDeductible field and toggle UI
✅ 17. BillsWidget error "data.filter is not a function" - API returns {data: [...], total, limit, offset} but component expected array. Fixed by extracting data.data and handling both array and object responses
✅ 18. Added Merchant field to transactions with inline creation feature:
   - Added merchantId field to transactions table in schema
   - Created database migration 0005_add_merchant_id.sql
   - Enhanced /api/merchants/route.ts with POST endpoint for creating merchants
   - Created /api/merchants/[id]/route.ts for PUT (update) and DELETE operations
   - Created MerchantSelector component with inline creation (similar to CategorySelector)
   - Integrated MerchantSelector into TransactionForm (hidden for transfers)
   - Created full Merchants management page at /dashboard/merchants with list, edit, delete, create
   - Added "Merchants" link to sidebar in Tools section
   - Merchants support usage count tracking and are sorted by usage

✅ 19. Separated merchants and description fields:
   - Removed MerchantAutocomplete from description field
   - Description field is now plain Input component
   - Merchant field is selected via separate MerchantSelector component
   - Merchant suggestions no longer appear in description field

✅ 20. Fixed internal server error when selecting description from dropdown:
   - Root cause: MerchantAutocomplete suggestion dropdown was causing errors
   - Solution: Replaced MerchantAutocomplete with plain Input for description

✅ 21. Added merchant and transfer information to transaction table display:
   - Shows merchant name if available
   - For transfers, shows "From Account → To Account" format
   - Added helper functions: getMerchantName, getAccountName, getTransactionDisplay
   - Transfer icon shows ArrowRightLeft in blue color
   - Reduced vertical space: p-4→p-2, space-y-3→space-y-2, removed type badge
   - Transactions now take up ~50% less vertical space

✅ 22. Fixed transaction creation 500 error - merchantId not handled:
   - Root cause: merchantId field added to schema/form but not extracted in API endpoints
   - POST /api/transactions now extracts merchantId from request body
   - PUT /api/transactions/[id] now supports merchantId updates
   - Removed old auto-merchant creation logic (conflicted with new MerchantSelector)
   - Now only tracks merchant usage when merchantId is explicitly provided
   - Updated validation to check for merchantId in update checks

✅ 23. Fixed 500 error on GET /api/transactions - better-sqlite3 bindings issue:
   - Root cause: Native bindings for better-sqlite3 weren't built
   - Solution: Cleaned .next directory and reinstalled dependencies with pnpm
   - pnpm install --force triggered proper build of better-sqlite3 native bindings
   - API now responds with {"error":"Unauthorized"} (expected Clerk auth error)
   - Transactions page should now load properly when authenticated

✅ 24. Fixed 500 error on GET /api/transactions - missing merchant_id column:
   - Root cause: Database migration 0005_add_merchant_id.sql wasn't applied to sqlite.db
   - Error: SqliteError: no such column: "merchant_id"
   - Solution: Created migration script to apply pending migrations manually
   - Applied migration: 0005_add_merchant_id (added merchant_id column and index)
   - API now returns proper Unauthorized error (authentication working)
   - RecentTransactions widget should now load when user is authenticated

✅ 25. Fixed recent transactions not showing merchant information:
   - Root cause: RecentTransactions component wasn't fetching or displaying merchant data
   - Missing: merchantId in Transaction interface, merchants/accounts state, helper functions
   - Solution:
     - Added merchantId, transferId to Transaction interface
     - Added Merchant and Account interfaces
     - Added merchants and accounts state
     - Fetch merchants and accounts data in useEffect
     - Added getMerchantName, getAccountName, getTransactionDisplay helper functions
     - Updated transaction display to show merchant name instead of just description
     - Updated repeat transaction logic to include merchantId
   - RecentTransactions widget now shows merchant names for transactions with merchants
   - Falls back to description if merchant not available
   - Handles transfers by showing "FromAccount → ToAccount" format

✅ 26. Fixed transaction page params Promise error:
   - Error: "A param property was accessed directly with `params.id`. `params` is a Promise..."
   - Root cause: Next.js 16 made params a Promise in dynamic routes
   - Solution:
     - Changed params interface type from object to Promise<{id: string}>
     - Imported React
     - Used React.use(params) to unwrap the Promise
     - Updated transactionId prop to use resolvedParams.id
   - Transaction details page now loads without errors

✅ 27. Fixed household page showing owner with no name:
   - Root cause: When creating household and when accepting invitations, userName wasn't being fetched from Clerk
   - Solution:
     - Imported clerkClient from '@clerk/nextjs/server'
     - In /api/households/route.ts POST: Fetch user from Clerk, extract firstName+lastName or firstName or username
     - In /api/invitations/accept/route.ts POST: Same approach for invited members
     - Now passes proper userName to householdMembers when creating records
   - Household members now display with their full names instead of blank

✅ 28. Fixed TransactionDetails component bgColor undefined error:
   - Error: "Cannot read properties of undefined (reading 'bgColor')" at line 159
   - Root cause: Transaction type was changed to 'transfer' but typeConfig and interface still referenced 'transfer_in'/'transfer_out'
   - Solution:
     - Updated Transaction interface type to include 'transfer' alongside 'transfer_in'/'transfer_out'
     - Added 'transfer' entry to typeConfig object
     - Added fallback to typeConfig.expense if type not found: `typeConfig[transaction.type as keyof typeof typeConfig] || typeConfig.expense`
     - Updated sign calculation to handle 'transfer' type
   - Transaction details page now loads without errors for all transaction types

PENDING BUGS:
